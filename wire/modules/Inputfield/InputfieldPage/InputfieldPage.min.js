function initInputfieldPage(a){a.find("p.InputfieldPageAddButton a").click(function(){var b=$(this).parent("p").next(".InputfieldPageAddItems");if(b.is(":visible")){b.slideUp("fast").find(":input").val("")}else{b.slideDown("fast").parents(".ui-widget-content").slice(0,1).effect("highlight",{},500)}return false});a.find(".findPagesSelector").each(function(){var i=$(this);var f=i.val();if(f.indexOf("=page.")==-1){return}var j=i.attr("data-label");var k=i.attr("data-formatname");if(!j.length){$labelFieldName="name"}var l=i.parents(".InputfieldPage");var g=$("select#"+l.attr("id").replace(/^wrap_/,""));if(g.length<1){return}var h=f.match(/(=page.[_a-zA-Z0-9]+)/g);for(var e=0;e<h.length;e++){var d=h[e];var c=d.replace("=page.","");var b=$("#Inputfield_"+c);if(b.length<1){return}b.change(function(){var o=f;var m=b.val();if(m==null){g.children().remove();g.change();return}m=m.toString();m=m.replace(/,/g,"|");o=o.replace(d,"="+m);o=o.replace(/,\s*/g,"&");if(o.indexOf("_LPID")){o=o.replace(/_LPID[0-9]+/g,"")}var n=ProcessWire.config.urls.admin+"page/search/for?"+o+"&limit=999&get="+j;if(k.length){n+="&format_name="+k}$.getJSON(n,{},function(s){g.children().addClass("option-tbd");for(e=0;e<s.matches.length;e++){var r=s.matches[e];var t=g.children("[value="+r.id+"]");var q=false;if(t.size()>0){q=t.is(":checked")}t.remove();var p="";if(k.length){p=r[k]}if(!p.length){p=r[j]}if(!p.length){p=r.name}var t=$("<option value='"+r.id+"'>"+p+"</option>");if(q){t.attr("selected","selected")}g.append(t)}$blankOption=$("<option value=''></option>");g.prepend($blankOption);g.children(".option-tbd").remove();g.change()})})}})}$(document).ready(function(){$(".InputfieldPage").each(function(){initInputfieldPage($(this))});$(document).on("reloaded",".InputfieldPage",function(){initInputfieldPage($(this))})});